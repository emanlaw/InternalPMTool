{% extends "base.html" %}

{% block title %}Gantt Analytics Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h2>Project Analytics Dashboard</h2>
            
            <!-- Project Health Overview -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card bg-success text-white">
                        <div class="card-body">
                            <h5>On Track</h5>
                            <h3 id="on-track-count">0</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-warning text-white">
                        <div class="card-body">
                            <h5>At Risk</h5>
                            <h3 id="at-risk-count">0</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-danger text-white">
                        <div class="card-body">
                            <h5>Overdue</h5>
                            <h3 id="overdue-count">0</h3>
                        </div>
                    </div>
                    </div>
                <div class="col-md-3">
                    <div class="card bg-info text-white">
                        <div class="card-body">
                            <h5>Completed</h5>
                            <h3 id="completed-count">0</h3>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5>Project Progress</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="progressChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5>Resource Utilization</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="resourceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Predictive Analytics -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>Predictive Analytics</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <h6>Estimated Completion</h6>
                                    <p id="estimated-completion" class="h4">-</p>
                                </div>
                                <div class="col-md-4">
                                    <h6>Budget Variance</h6>
                                    <p id="budget-variance" class="h4">-</p>
                                </div>
                                <div class="col-md-4">
                                    <h6>Risk Score</h6>
                                    <p id="risk-score" class="h4">-</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Metrics -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>Performance Metrics</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Report Generation -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>Generate Reports</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <select class="form-control mb-2" id="reportType">
                                        <option value="project-health">Project Health Report</option>
                                        <option value="resource-utilization">Resource Utilization Report</option>
                                        <option value="performance-metrics">Performance Metrics Report</option>
                                        <option value="risk-assessment">Risk Assessment Report</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <button class="btn btn-primary" onclick="generateReport()">Generate Report</button>
                                    <button class="btn btn-secondary" onclick="scheduleReport()">Schedule Report</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Report Modal -->
<div class="modal fade" id="reportModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Generated Report</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="reportContent">
                <!-- Report content will be loaded here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="downloadReport()">Download PDF</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/static/js/gantt_analytics.js"></script>
{% endblock %}